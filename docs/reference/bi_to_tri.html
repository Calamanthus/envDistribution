<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Convert binomial (species) level occurrences to trinomial based on distributions. — bi_to_tri • envDistribution</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Convert binomial (species) level occurrences to trinomial based on distributions. — bi_to_tri"><meta property="og:description" content="Convert binomial (species) level occurrences to trinomial based on distributions."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">envDistribution</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/Calamanthus/envDistribution/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Convert binomial (species) level occurrences to trinomial based on distributions.</h1>
    <small class="dont-index">Source: <a href="https://github.com/Calamanthus/envDistribution/blob/HEAD/R/bi_to_tri.R" class="external-link"><code>R/bi_to_tri.R</code></a></small>
    <div class="hidden name"><code>bi_to_tri.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Convert binomial (species) level occurrences to trinomial based on distributions.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">bi_to_tri</span><span class="op">(</span></span>
<span>  <span class="va">species</span>,</span>
<span>  <span class="va">presences</span>,</span>
<span>  distrib_files <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  use_mcp <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  mcp_files <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  use_clust <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  pres_x <span class="op">=</span> <span class="st">"long"</span>,</span>
<span>  pres_y <span class="op">=</span> <span class="st">"lat"</span>,</span>
<span>  pres_crs <span class="op">=</span> <span class="fl">4326</span>,</span>
<span>  use_crs <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  buf <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  clust_dist <span class="op">=</span> <span class="fl">50000</span>,</span>
<span>  overrides <span class="op">=</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span><span class="op">~</span><span class="va">subspecies</span>, <span class="op">~</span><span class="va">poly</span>, <span class="st">"Stipiturus malachurus intermedius"</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"dist"</span>, <span class="st">"mcp"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>species</dt>
<dd><p>Character. Name of the species (binomial) to update occurrences to trinomial for.</p></dd>


<dt>presences</dt>
<dd><p>Data frame of all binomial and trinomial presences relevant to the species.
Must contain a 'subspecies' column and x, y coordinate columns corresponding to the names
in <code>pres_x</code> &amp; <code>pres_y</code>. For binomial presences 'subspecies' should be NA.</p></dd>


<dt>distrib_files</dt>
<dd><p>Data frame of relevant distribution file paths for all the subspecies
(e.g. for distributions sourced from redlist, epbc etc). If no relevant distribution, then use NA.
Currently, only geoparquet files are accepted. Use sfarrow::st_write_parquet to write sf objects to parquet.</p></dd>


<dt>use_mcp</dt>
<dd><p>Logical. Use a minimum convex polygon (MCP) around presences to determine relevant trinomials?</p></dd>


<dt>mcp_files</dt>
<dd><p>If use_mcp == TRUE, optional data frame of file paths of existing mcp files to be used.
If use_mcp == TRUE and mcp_file == NULL, a new mcp will be constructed from <code>presences</code>.
Currently, only geoparquet files are accepted. Use sfarrow to convert sf objects to geoparquet.</p></dd>


<dt>use_clust</dt>
<dd><p>Logical. Use clusters around around presences to determine relevant trinomials?
If TRUE, <code>use_crs</code> must correspond to a projected crs to allow clustering on a positive set of numbers.</p></dd>


<dt>pres_x, pres_y</dt>
<dd><p>Character. Name of the columns in <code>presences</code> that have
the x and y coordinates.</p></dd>


<dt>use_crs</dt>
<dd><p>Integer. Coordinate reference system (epsg code) to use as the standard for all objects in spatial joins.
Using a projected coordinate system removes the sf warning around assuming coordinates are planar if they're not, and
can sometimes help with spherical geometry issues. If NULL, the crs of the distribution will be used as the standard
(i.e. the <code>presences</code> will be converted to this crs before joining or intersecting).</p></dd>


<dt>buf</dt>
<dd><p>Integer. Distance in metres to buffer the distribution.</p></dd>


<dt>clust_dist</dt>
<dd><p>Integer. Distance to base clusters on in clust function if <code>use_clust</code> = TRUE.
Needs to be in the units of the projected crs supplied in <code>use_crs</code>, e.g. metres.</p></dd>


<dt>overrides</dt>
<dd><p>Data frame containing subspecies and poly columns indicating any subspecies to
override the overlap checking and force binomials to be updated within the polygon type
specified in 'poly', where 'poly' is a vector of values containing any of 'dist',
'mcp' or 'clust' for distribution, minimum convex polygon or cluster respectively.</p></dd>


<dt>in_crs</dt>
<dd><p>Integer. Coordinate reference system (epsg code) for coordinates in <code>presences</code>.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>Data frame equivalent to <code>presences</code> with 'subspecies' updated
for taxa where distributions were found and did not overlap with multiple trinomials in presence or distributions,
and an additional 'bi_to_tri' column indicating which records were updated.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>Will only update binomial occurrence records that fall within a distribution polygon to trinomial if no other
trinomial presences or distributions for a species are found intersecting the distribution polygon.
This avoids updating binomials to the wrong trinomial where distributions of subspecies overlap.
Distribution refers generally to all the polygons used to represent distributions,
i.e. distribution files (e.g. from redlist or epbc), MCPs, or cluster polygons.</p>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Joel Allan, Nigel Willoughby.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer></div>

  


  

  </body></html>

